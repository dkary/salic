---
title: "Introduction to salic"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE, message = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 7
)
library(dplyr)
library(salic)
```

Salic helps you get from license data to dashboard summaries. It also provides package dplyr on installation ([dplyr intro](https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html)). You'll want to load both packages:

```{r}
library(salic)
library(dplyr)
```

This vignette walks through salic functionality using provided sample data (run `?data_salic` for more info).

## Standardized Data

To provide a generalizable workflow, salic is strict about the license data format. Fortunately, the data needs for the project are light: 3 tables (cust, lic, sale) with 9 columns total.

### Customers (cust table)

Only 3 customer columns are needed (cust_id being the most important):

```{r}
data(cust)
head(cust)
```

### License Types (lic table)

### License Sales (sale table)

## Standardizing License Data

These need to be prepared into a standardized format (which is also anonymized to remove any personally-identifiable information).

This process is state-specific since agencies vary in how license data is stored. The standardization is intended to produce a standard format that is well-suited for the generalized presented here. An important part of this step involves anonymizing data by excluding any personally identifiable information from the standard storage format.

### Sample Data

To get started, first load package dependencies:

```r
library(salic)
library(dplyr)
```

Samples of standardized data are provided in salic:

```{r}
data(cust)
glimpse(cust)

data(lic)
glimpse(lic)

data(sale)
glimpse(sale)
```

A function is provided to check that your data fits the specifications (strict for this reason...):

```r
# produces no output (i.e., silent) if no issues detected
check_format(cust, lic, sale)
```

## Building License History

- `rank_sale()` to do this...
    + `join_first_month()` to do that...
    
- `make_lic_history()`
    + `identify_R3()`
    + `identify_lapse()`

Need to also consider the key parameters for this process:

- permission: specifically related to license types include (fish, hunt, combo)
- timeframe: full-year or mid-year
- years

## Calculating Dashboard Metrics

- filter by age
- `label_categories()` & `recode_agecat()`
- `est_part()`, `est_recruit()`, `est_churn()`

### Formatting for final Output

